<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2020-12-22 Tue 11:22 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>BindingGenerations.net</title>
<meta name="generator" content="Org mode">
<meta name="author" content="emsenn">
</head>
<body>
<div id="preamble" class="status">
<section class="nav"><a href="file:///home/emsenn/org/p/personal/index.html">homepage</a> <a href="file:///home/emsenn/org/p/personal/records.html">record index</a> <a href="file:///home/emsenn/org/p/personal/d/index.html">daily records</a></section>
</div>
<div id="content">
<header>
<h1 class="title">BindingGenerations.net</h1>
</header><p>
<b><i>BindingGenerations.net</i></b> is the personal website of <a href="20201216103031-esther_davis.html">Esther Davis</a>. This file is my notes on building up that <a href="20201215151949-website.html">Website</a>.
</p>
<section id="outline-container-org09c189d" class="outline-2">
<h2 id="org09c189d">Getting Started</h2>
<div class="outline-text-2" id="text-org09c189d">
<p>
Before creating this <a href="20201216131742-note.html">note</a>, I have already made a few decisions about how the Website should work, that I discussed with Esther. They're trusting me that they'll be a fan of the <a href="20201215154118-zettelkasten_method.html">Zettelkasten method</a> of <a href="20201215151536-note_taking.html">note-taking</a>, and because of other decisions made in relationship to the <a href="20201216131832-webgaz.html">WebGAZ</a>, <a href="20201215150328-org_roam.html">Org-roam</a> seems like the best way of creating those notes. (The fact its built on-top of <a href="20201215150436-org_mode.html">Org-mode</a> and so its notes will be suitable for independent export as <a href="20201216131936-pdf.html">PDFs</a> is a nice bonus, but honestly unrelated to the choice to use Org-roam.
</p>

<p>
I've been using Org-roam myself since yesterday, and so my first task is to configure some sort of&#x2026; not-my-own <a href="20201216132036-org_roam_directory.html">Org-roam directory</a>, so that I can separate the notes for BN.net from my notes. <a href="https://www.orgroam.com/manual.html#How-do-I-have-more-than-one-Org_002droam-directory_003f">Section 21.1</a> of the Org-roam manual seems to have the answer, but not enough context for me to know for sure: I'm not sure if I understand how <a href="20201215150459-emacs.html">Emacs</a> handles "directory-local variables," as that section calls it.
</p>

<p>
The relevant section of the manual, <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Directory-Variables.html">49.2.5</a>, gives the context to make it clear: I want to put the following lines in <code>~/org/edavis/roam/.dir-locals.el</code>, where I'll be keeping the source data for BN.net.
</p>

<div class="org-src-container">
<pre class="src src-elisp">((nil . ((org-roam-directory . <span class="org-string">"."</span>)
       (org-roam-db-location . <span class="org-string">"./org-roam.db"</span>))))
</pre>
</div>

<p>
With that directory in place, I can start to capture Org-roam notes while in that directory. I seeded it with one for Esther Davis, to kick things off, and now I want to set up an <a href="20201216150628-org_publish.html">Org-publish</a> project for rendering out those notes as a Website.
</p>

<p>
Yesterday I found <a href="https://commonplace.doubleloop.net/20200821142536-how_i_publish_my_wiki_with_org_publish">"How I publish my wiki with org-publish"</a> on the <a href="20201216150949-commonplace_wiki.html">Commonplace wiki</a>, and it's probably a good resource for getting a publishing process set up myself. (I looked for how <a href="20201216151229-jethro_kuan.html">Jethro Kuan</a> publishes their <a href="https://braindump.jethro.dev/">braindump</a> but didn't find it.)
</p>

<p>
It's actually Doubleloop's <a href="https://gitlab.com/ngm/commonplace/-/blob/master/publish.el"><code>publish.el</code></a> that I want to look at, apparently.
</p>

<p>
Let's start with a simple projects list and see how that looks, exported:
</p>

<div class="org-src-container">
<pre class="src src-elisp">(<span class="org-keyword">setq</span> org-publish-project-alist
      `((<span class="org-string">"bindinggenerations"</span>
         <span class="org-builtin">:base-directory</span> <span class="org-string">"~/org/edavis/roam"</span>
         <span class="org-builtin">:base-extension</span> <span class="org-string">"org"</span>
         <span class="org-builtin">:publishing-directory</span> <span class="org-string">"~/org/edavis/public"</span>
         <span class="org-builtin">:publishing-function</span> org-html-publish-to-html
         <span class="org-builtin">:recursive</span> t
         <span class="org-builtin">:headline-levels</span> 4
         <span class="org-builtin">:with-toc</span> nil
         <span class="org-builtin">:html-doctype</span> <span class="org-string">"html5"</span>
         <span class="org-builtin">:html-html5-fancy</span> t
         <span class="org-builtin">:html-head-include-scripts</span> nil
         <span class="org-builtin">:html-head-include-default-style</span> nil
         <span class="org-builtin">:html-container</span> <span class="org-string">"section"</span>
         <span class="org-builtin">:htmlized-source</span> nil
         <span class="org-builtin">:auto-sitemap</span> t
         <span class="org-builtin">:sitemap-title</span> <span class="org-string">"Notes"</span>
         <span class="org-builtin">:sitemap-sort-files</span> anti-chronologically
         <span class="org-builtin">:sitemap-filename</span> <span class="org-string">"notes.org"</span>)))
</pre>
</div>

<p>
That definitely works - I end up with a <code>posts.html</code> and a <code>20...-esther_davis.html</code>. Two things I see I need to change: it uses me as the author, and I need some sort of index page.
</p>

<p>
I think I can accomplish the former by tweaking <code>.dir-locals.el</code>
</p>

<div class="org-src-container">
<pre class="src src-elisp">((nil . ((org-roam-directory . <span class="org-string">"."</span>)
         (org-roam-db-location . <span class="org-string">"./org-roam.db"</span>)
         (user-full-name <span class="org-string">"Esther Davis"</span>))))
</pre>
</div>

<p>
Dang, nope! That's not too important though - we want to have the author hard-coded into the note file, which means tweaking our capture templates. First, to address the second of the issues above, I want to try manually adding an <code>index.org</code> to <code>~/org/edavis/roam.org</code> and see what that gets us, in Org-roam and the Website.
</p>


<p>
That worked, okay. Tabling the "wrong author" problem for now, since it'll get resolved by the next step: setting up <a href="20201216154325-org_roam_capture_templates.html">Org-roam capture templates</a>.
</p>

<p>
<a href="https://www.orgroam.com/manual.html#The-Templating-System">Section 7</a> of the Org-roam manual talks about its extension/hijacking of <a href="20201216154426-org_mode_capture_templates.html">Org-mode capture templates</a>.
</p>

<div class="org-src-container">
<pre class="src src-elisp">(<span class="org-keyword">setq</span> org-roam-capture-templates
      `((<span class="org-string">"b"</span> <span class="org-string">"Binding Generations records"</span>)
        (<span class="org-string">"bn"</span> <span class="org-string">"General note"</span>
         plain (<span class="org-keyword">function</span> org-roam--capture-get-point)
         <span class="org-string">"%?"</span>
         <span class="org-builtin">:file-name</span> <span class="org-string">"%&lt;%Y%m%d%H%M%S&gt;-${slug}"</span>
         <span class="org-builtin">:head</span> <span class="org-string">"#+title: ${title}\n#+author: Esther Davis\n#+email: edavis@bindinggenerations.net\n"</span>
         <span class="org-builtin">:unnarrowed</span> t)
        (<span class="org-string">"bb"</span> <span class="org-string">"Bibliographical entry"</span>
         plain (<span class="org-keyword">function</span> org-roam--capture-get-point)
         <span class="org-string">"#+title: %^{AUTHOR}: \"%^{TITLE}\"\n#+author: Esther Davis\n#+email: edavis@bindinggenerations.net\n%?"</span>
         <span class="org-builtin">:file-name</span> <span class="org-string">"%&lt;%Y%m%d%H%M%S&gt;-%{slug}"</span>
         <span class="org-builtin">:unnarrowed</span> t)))
</pre>
</div>

<p>
The above all seems to work, and the only thing I really need these pages to have right now is a listing of backlinks on each note, which might be easy to extract from Doubleloop's <code>publish.el</code>
</p>

<div class="org-src-container">
<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">commonplace/org-roam--backlinks-list</span> (file)
  (<span class="org-keyword">if</span> (org-roam--org-roam-file-p file)
      (<span class="org-keyword">--reduce-from</span>
       (concat acc (format <span class="org-string">"- [[file:%s][%s]]\n"</span>
                           (file-relative-name (car it) org-roam-directory)
                           (org-roam-db--get-title (car it))))
       <span class="org-string">""</span> (org-roam-db-query [<span class="org-builtin">:select</span> [source] <span class="org-builtin">:from</span> links <span class="org-builtin">:where</span> (= dest $s1)] file))
    <span class="org-string">""</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">commonplace/org-export-preprocessor</span> (backend)
  (<span class="org-keyword">let</span> ((links (commonplace/org-roam--backlinks-list (buffer-file-name))))
    (<span class="org-keyword">unless</span> (string= links <span class="org-string">""</span>)
      (<span class="org-keyword">save-excursion</span>
        (goto-char (point-max))
        (insert (concat <span class="org-string">"\n* Backlinks\n"</span>) links)))))

(add-hook 'org-export-before-processing-hook 'commonplace/org-export-preprocessor)
</pre>
</div>

<p>
That actually seems to have worked to do exactly what I wanted it to do, and so now the big challenge will be figuring out the specific schema for notes, tweaking capture templates, and the rendering of HTML and its CSS.
</p>

<p>
But before I can really get further in those problems, I need to figure out how to not get my notes so messy, and so that I don't end up losing useful code snippets here in the notes, or, worse, have useful code that contradicts itself being extracted and applied out of them!
</p>
</div>
</section>


<section id="outline-container-org2b7398a" class="outline-2">
<h2 id="org2b7398a">Backlinks</h2>
<div class="outline-text-2" id="text-org2b7398a">
<ul class="org-ul">
<li><a href="d/2020-12-17.html">2020-12-17</a></li>
<li><a href="d/2020-12-17.html">2020-12-17</a></li>
<li><a href="records.html">Records Index</a></li>
</ul>
</div>
</section>
</div>
<div id="postamble" class="status">
<p class="author">Author: emsenn</p>
<p class="date">Created: 2020-12-22 Tue 11:22</p>
</div>
</body>
</html>
